import datetime
from documentation import loginfo

def cleanReport():
    f = open("../report/report.md", "w")
    f.write("")
    f.close

def createReport(name, website):
    f = open("../report/report.md", "a")
    f.write("# Report for %s\n" % (website))
    f.write("This is the report from Pentester: %s testing on the %s\n\n" %(name, str(datetime.datetime.now())))
    f.write("This document was created automatically using the WebPenTestGuide\n\n")

    f.write("## Information\n")
    f.write("The information for this reporting was taken from the logs that were created during the execution.\n\n")

    for l in loginfo.infos:
        if "Information" in l['type']:
            f.write("- Information : **%s** at %s\n" %(l["info"], l['step']))
    f.write("\n")

    f.write("## Found Vulnerabilities\n")
    f.write("These are the vulnerabilites, that the pentester found using the software\n")

    for l in loginfo.infos:
        if "Vulnerability" in l['type']:
            f.write("- **%s** at %s\n" %(l["info"], l['step']))
    f.write("\n")
    
    f.write("## Found Exploits\n")
    f.write("These are the exploits, that the pentester found using the software\n")

    for l in loginfo.infos:
        if "Warning" in l['type']:
            f.write("- **%s** \n \t- at Step: %s \n\t\t \n" %(l["info"], l['step']))
    f.write("\n")


    f.write("## Entire Log of WebPenTestGuide\n")
    f.write("With logs, it should be possible to redo it the same as before the first test.")
    f.write("```bash\n")
    log = open("../result/results.log", "r")
    logs = log.read()
    f.write(logs)
    f.write("```\n\n")

    f.write("_____\n")
    f.write("This file can be edited, adding steps, that were not included in this tool.\n")
    f.write("When the file is done and checked, it can be sent out to the customer/tested website\n\n")
 

    f.close()