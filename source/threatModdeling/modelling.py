from documentation import logger
from . import threats

step = "Threat Modelling"


def runChecks():
    funcs = [modelTexts,modelFileUpload, modelSessionHijacking]
    for f in funcs:
        f()
    print("|- All Threat Modelling measurements from this tool are executed.")
    print("|- Finishing Threat Modelling phase...")
    print("____________________________________________________")

def checkForKeyword(keyword):
    f = open("../result/results.log", "r")
    truth = False
    for l in f:
        if keyword in l:
            print("Found %s" %(keyword))
            truth = True
    return truth

def modelTexts():
    if checkForKeyword("text-field"):
        logger.log("Adding XSS and SQL Injection to possible attacks", step)
        threats.xss = True
        threats.sql = True

def modelFileUpload():
    if checkForKeyword("file upload"):
        logger.log("Adding File Upload to possible attacks", step)
        threats.fileUpload = True

def modelSessionHijacking():
    if checkForKeyword("Session Hijacking"):
        logger.log("Adding Session Hijacking to possible attacks", step)
        threats.sessionHijaking = True
