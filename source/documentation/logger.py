import datetime
from . import loginfo

def openFile():
    return open("../result/results.log", "a")


def cleanFile():
    f = open("../result/results.log", "w")
    f.write("")
    f.close()

def writeToFile(info):
    f = openFile()
    output = f"[type : %s with: \"%s\" at step: | %s | at :%s]\n" %(info["type"], info["info"], info["step"], info["time"])
    loginfo.append(info)
    f.write(output)
    f.close()


def log(information, step):
    info = {"type": "Information", "time":str(datetime.datetime.now()), "info":information, "step":step}
    writeToFile(info)


def vulnerable(step, message):
    info = {"type": "Vulnerability", "time":str(datetime.datetime.now()), "info":message, "step":step}
    writeToFile(info)


def warning(step, message, location):
    info = {"type": "Warning", "time":str(datetime.datetime.now()), "info":message+", location: "+location, "step":step}
    writeToFile(info)