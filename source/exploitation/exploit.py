from documentation import logger
from threatModdeling import threats

step = "Exploitation"


def runChecks():
    funcs = [createXSS, createSQL, createFileUpload, createSessionHijacking]
    for f in funcs:
        f()
    print("|- All Exploitation measurements from this tool are executed.")
    print("|- Finishing Exploitation phase...")
    print("____________________________________________________")

def createXSS():
    if threats.xss:
        print("|- As there is a textbox for users, try using the following input:")
        print("|     <script>alert('Cross Site Scripting')</script>      |")
        print("|- If the attack was succesfull, you should see a popup with the text: 'Cross Site Scripting'")
        ans = ""
        while not ans == "stop":
            ans = input("Did you see it? (y/n): ")
            if ans == "y" or "yes":
                location = input("Where did you find it: ")
                logger.warning(step, "XSS attack was successful", location)
            ans = input("Did you find every XSS from the website, then type stop:")


def createSQL():
    if threats.sql:
        print("|- As there is a textbox for users, try using the following input:")
        print("|     ' OR '1'='1      |")
        print("|- If the attack was succesfull, you should see all entries in the database")
        ans = ""
        while not ans == "stop":
            ans = input("Did you see it? (y/n): ")
            if ans == "y" or "yes":
                location = input("Where did you find it: ")
                logger.warning(step, "SQL-Injection attack was successful", location)
            ans = input("Did you find every SQL-Injection from the website, then type stop:")

def createFileUpload():
    if threats.fileUpload:
        print("|- As there is a fileupload for users, try uploading the files inside this projects 'fileUpload' directory")
        print("|- If the attack was succesfull, you should be able to access this file and see it rendered on your browser")
        ans = ""
        while not ans == "stop":
            ans = input("Did you see it? (y/n): ")
            if ans == "y" or "yes":
                location = input("Where did you find it: ")
                logger.warning(step, "File Upload attack was successful", location)
            ans = input("Did you find every File Upload from the website, then type stop:")

def createSessionHijacking():
    if threats.sessionHijaking:
        print("|- As Session Hijacking seems to be possible, try 'guessing' or reading another Session ID")
        print("|- If the attack was succesfull, you should be logged in as a different user")
        ans = ""
        while not (ans == "y" or ans =="yes" or ans == "no" or ans == "n"):
            ans = input("Did you see it? (y/n): ")
            if ans == "y" or "yes":
                logger.warning(step, "File-Upload attack was successful", "entire Website")
