from documentation import logger

step = "Recconnaissance"

def runChecks():
    funcs = [findText, findFileUpload, checkLoginAuthentification, checkSessions, checkDirectoryTraversal]
    for f in funcs:
        f()
    print("|- All reconnaissance measurements from this tool are executed. If you find other methods, you can do them yourself and input them here:")
    ans = ""
    print("|- Another method you know, that could be a threat?")
    while not ans == "stop":
        ans = input("If not write 'stop' else, put in here:")
    print("|- Finishing reconnaissance phase...")
    print("____________________________________________________")

def findText():
    print("|- Gathering: Can you find text-fields, you can access?")
    ans = input("|- (y/n): ")
    if ans=="y" or ans=="yes":
        logger.log("Found text-field, that could be used as a vulnerability", step)

def findFileUpload():
    print("|- Gathering: Can you find file uploads, you can access?")
    ans = input("|- (y/n): ")
    if ans=="y" or ans=="yes":
        logger.log("Found file upload, that could be used as a vulnerability", step)

def checkLoginAuthentification():
    print("|- Gathering: When trying to log in, can you see whether ONLY a password or username is wrong?")
    ans = input("|- (y/n): ")
    if ans=="y" or ans=="yes":
        logger.vulnerable(step, "Authentification Exploit: Users see, whether ONLY a passwort or username is wrong")

def checkSessions():
    print("|- Gathering: While reading the Session Token, can you find an easy pattern?")
    ans = input("|- (y/n): ")
    if ans=="y" or ans=="yes":
        pattern = input("What pattern do you see: ")
        logger.vulnerable(step, "Session Hijacking: It's easy to see the Session-ID Pattern, with pattern %s" %(pattern))

def checkDirectoryTraversal():
    print("|- Gathering: While changing the URL, can you gain access to other files than the website?")
    ans = input("|- (y/n): ")
    if ans=="y" or ans=="yes":
        logger.vulnerable(step, "DirectoryTraversal: Possibly can get unwanted access to servers files")