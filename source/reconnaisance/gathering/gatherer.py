from documentation import logger

step = "Recconnaissance"

def runChecks():
    funcs = [findText, findFileUpload, checkLoginAuthentification, checkSessions, checkDirectoryTraversal]
    for f in funcs:
        f()
    ans = ""
    while not ans == "stop":
        print("Do you know of any other Exploitation, you could use (y/n/stop)?")
        ans = input("> ")
        if ans == "yes" or ans == "y":
            print("Okay, what attack could be executed?")
            vulnerability = input("> ") + " attack is possible"
            logger.vulnerable(vulnerability, step)
    print("|- Finishing reconnaissance phase...")
    print("____________________________________________________")

def findText():
    print("|- Gathering: Can you find text-fields, you can access?")
    ans = input("|- (y/n): ")
    if ans=="y" or ans=="yes":
        logger.log("Found text-field, that could be used as a vulnerability", step)

def findFileUpload():
    print("|- Gathering: Can you find file uploads, you can access?")
    ans = input("|- (y/n): ")
    if ans=="y" or ans=="yes":
        logger.log("Found file upload, that could be used as a vulnerability", step)

def checkLoginAuthentification():
    print("|- Gathering: When trying to log in, can you see whether ONLY a password or username is wrong?")
    ans = input("|- (y/n): ")
    if ans=="y" or ans=="yes":
        logger.vulnerable(step, "Authentification Exploit: Users see, whether ONLY a passwort or username is wrong")

def checkSessions():
    print("|- Gathering: While reading the Session Token, can you find an easy pattern?")
    ans = input("|- (y/n): ")
    if ans=="y" or ans=="yes":
        pattern = input("What pattern do you see: ")
        logger.vulnerable(step, "Session Hijacking: It's easy to see the Session-ID Pattern, with pattern %s" %(pattern))

def checkDirectoryTraversal():
    print("|- Gathering: While changing the URL, can you gain access to other files than the website?")
    ans = input("|- (y/n): ")
    if ans=="y" or ans=="yes":
        logger.vulnerable(step, "DirectoryTraversal: Possibly can get unwanted access to servers files")