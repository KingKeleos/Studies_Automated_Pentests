import datetime


def openFile():
    return open("../documentation/results.log", "a")


def cleanFile():
    f = open("../documentation/results.log", "w")
    f.write("")
    f.close()


def log(information, step):
    f = openFile()
    string = '{%s {Information: %s, During Step: %s}}' % (datetime.datetime.now(), information.strip(), step.strip())
    f.write(string+"\n")
    print(string)
    f.close()


def vulnerable(level, step, message):
    f = openFile()
    string = '{%s {Vulnerability found: %s, During Step: %s, with Message: %s}}' % (datetime.datetime.now(),
                                                                                    level.strip(), step.strip(),
                                                                                    message.strip())
    f.write(string+"\n")
    print(string)
    f.close()


def warning(step, message):
    f = openFile()
    string = '{%s {!--Warning--! During Step: %s, with Message: %s}}' % (datetime.datetime.now(),
                                                                         step.strip(), message.strip())
    f.write(string+"\n")
    print(string)
    f.close()


def error(step, message):
    f = openFile()
    string = '{%s {Error Occurred, During Step: %s, with Message: %s}}' % (datetime.datetime.now(),
                                                                           step.strip(), message.strip())
    f.write(string+"\n")
    print(string)
    f.close()


def secure(level, step, message):
    f = openFile()
    string = '{%s {Vulnerability on Level %s , During Step: %s, with Message: %s was secured by the website}}' % \
             (datetime.datetime.now(), level.strip(), step.strip(), message.strip())
    f.write(string+"\n")
    print(string)
    f.close()