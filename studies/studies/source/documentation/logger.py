import datetime
import json


def openFile():
    return open("result/results.json", "a")


def cleanFile():
    f = open("../result/results.json", "w")
    f.write("")
    f.close()


def log(information, step):
    f = openFile()
    log = {
        "type": "Information",
        "time": str(datetime.datetime.now()),
        "info": information,
        "step" : step,
    }
    string = json.dumps(log, indent=4)
    f.write(string)
    print(string)
    f.close()


def vulnerable(step, message):
    f = openFile()
    log = {
        "type": "Vulnerability",
        "time": str(datetime.datetime.now()),
        "step" : step,
        "message": message.strip()
    }
    string = json.dumps(log, indent=4)
    f.write(string)
    print(string)
    f.close()


def warning(step, message):
    f = openFile()
    log = {
        "type": "Warning",
        "time": str(datetime.datetime.now()),
        "step" : step,
        "message": message.strip()
    }
    string = json.dumps(log, indent=4)
    f.write(string+"\n")
    print(string)
    f.close()


def error(step, message):
    f = openFile()
    log = {
        "type": "Error",
        "time": str(datetime.datetime.now()),
        "step" : step,
        "message": message.strip()
    }
    string = json.dumps(log, indent=4)
    f.write(string+"\n")
    print(string)
    f.close()